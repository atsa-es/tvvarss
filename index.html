<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Time Varying Vector Autoregressive State Space Models • tvvarss</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Time Varying Vector Autoregressive State Space Models">
<meta property="og:description" content="The tvvarss package uses Stan (mc-stan.org) to fit multi-site
    multivariate autoregressive (aka vector autoregressive) state space models
    with a time varying interaction matrix.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tvvarss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/intro_tvvarss.html">Introduction to using time varying vector autoregressive models (TVVARSS)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nwfsc-timeseries/atsar/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<ul class="nav">
<li>
<p><a href="#install">Install</a></p>
</li>
<li>
<p><a href="#data">Data</a></p>
</li>
<li>
<p><a href="#models">Model structure</a></p>
</li>
<li>
<p><a href="#variances">Variances</a></p>
</li>
<li>
<p><a href="#processes">Processes</a></p>
</li>
<li>
<p><a href="#families">Families</a></p>
</li>
<li>
<p><a href="#cite">Citation info</a></p>
</li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><code>tvvarss</code> is an R package used to simulate and/or fit time-varying vector autoregressive state space models of community interactions. Models are fit via Hamiltonian Monte Carlo (HMC) using the <a href="http://mc-stan.org/">Stan</a> software</p>
<p>After installing <code>devtools</code> (and assuming you have a C++ compiler installed), you can install the package with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"atsa-es/tvvarss"</span><span class="op">)</span></code></pre></div>
<p>A short vignette for the package is:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html">vignette</a></span><span class="op">(</span><span class="st">"intro_tvvarss"</span>, package <span class="op">=</span> <span class="st">"tvvarss"</span><span class="op">)</span></code></pre></div>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h3>
<p><code>tvvarss</code> takes data as an array, with dimensions (site, year, species). Using multiple sites or multiple species is completely optional, and we assume 1 measurement per site-year-species combination (for multiple measurements, these may be created as replicate sites).</p>
<p>Simulated data may be generated with our built in simulation function <code>simTVVAR</code>, which is demonstrate in the vignette</p>
</div>
<div id="model-structure" class="section level3">
<h3 class="hasAnchor">
<a href="#model-structure" class="anchor"></a>Model structure</h3>
<p>We allow the <span class="math inline"><strong>B</strong></span> matrix in a conventional MAR model to be either static or time varying – time varying models are assumed by default, but may changed to static matrices with the</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/tvvarss.html">tvvarss</a></span><span class="op">(</span><span class="va">y</span>, dynamicB <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Because the number of elements in <span class="math inline"><strong>B</strong></span> may not be identifiable, we also allow constraints to be passed in, depending on the food web structure. This is done with the <code>topo</code> argument, which is detailed in the package vignette.</p>
</div>
<div id="variances" class="section level3">
<h3 class="hasAnchor">
<a href="#variances" class="anchor"></a>Variances</h3>
<p>We allow process and observation variances to be shared across sites or species. These are set with the arguments is dimensioned (number of species x number of sites), and elements are passed in as integers.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/tvvarss.html">tvvarss</a></span><span class="op">(</span><span class="va">y</span>, shared_q <span class="op">=</span> <span class="va">Q</span>, shared_r <span class="op">=</span> <span class="va">R</span><span class="op">)</span></code></pre></div>
<p>For example, if we had a dataset consiting of 3 sites and 5 species, the default form of these matrices in the function would be a unique variance by species, that was shared across sites, e.g.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>m =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) m[i,] =<span class="st"> </span>i</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw">colnames</span>(m) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"Site "</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">rownames</span>(m) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"Species "</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a>knitr<span class="op">::</span><span class="kw">kable</span>(m)</span></code></pre></div>
<p>We could change this up, and make variances be unique to each species-site</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>m =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">colnames</span>(m) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"Site "</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">rownames</span>(m) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"Species "</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(m)</span></code></pre></div>
<p>Or equal across species - sites</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>m =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">colnames</span>(m) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"Site "</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw">rownames</span>(m) =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"Species "</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(m)</span></code></pre></div>
</div>
<div id="processes" class="section level3">
<h3 class="hasAnchor">
<a href="#processes" class="anchor"></a>Processes</h3>
<p>In some situations, like the replicate observations described above, we may want to relate sites as measurements of the same underlying state. This can be done with the ‘process’ argument, which maps sites to states.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/tvvarss.html">tvvarss</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, process <span class="op">=</span> <span class="va">Z</span><span class="op">)</span></code></pre></div>
<p>By default each site is its own process, so for the 3 site example, <code>process</code> would be</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">process</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></code></pre></div>
<p>These could be shared though – if sites 1 and 3 were a different process than site 2, this could be expressed as</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">process</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
<div id="families" class="section level3">
<h3 class="hasAnchor">
<a href="#families" class="anchor"></a>Families</h3>
<p>We’ve implemented a few distribution families that may be useful for modeling non-normal data.</p>
<p>The default family is “gaussian”, but</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/tvvarss.html">tvvarss</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></code></pre></div>
<p>the family can be any of the following: “gaussian”, “binomial”, “poisson”, “gamma”, “lognormal”. We assumea logit link for modeling the binomial, and a log link for the Gamma, poisson, and lognormal.</p>
</div>
<div id="citation" class="section level3">
<h3 class="hasAnchor">
<a href="#citation" class="anchor"></a>CITATION</h3>
<p>Ward, E.J., M.D. Scheuerell, and S.L. Katz. 2021. ‘tvvarss’: Time varying vector autoregressive models in Stan. <a href="https://zenodo.org/badge/latestdoi/47343421"><img src="https://zenodo.org/badge/47343421.svg" alt="DOI"></a></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/nwfsc-timeseries/atsar/">https://​github.com/​nwfsc-timeseries/​atsar/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/nwfsc-timeseries/atsar/issues">https://​github.com/​nwfsc-timeseries/​atsar/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=3)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Eric Ward <br><small class="roles"> Author, maintainer </small>  </li>
<li>Mark Scheuerell <br><small class="roles"> Author </small>  </li>
<li>Steve Katz <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/eric-ward/TVVARSS/actions"><img src="https://github.com/eric-ward/TVVARSS/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/47343421"><img src="https://zenodo.org/badge/47343421.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Eric Ward, Mark Scheuerell, Steve Katz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
