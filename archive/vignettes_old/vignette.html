<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Eric Ward, Mark Scheuerell, Steve Katz" />


<title>Using the tvvarss package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using the <code>tvvarss</code> package</h1>
<h4 class="author"><em>Eric Ward, Mark Scheuerell, Steve Katz</em></h4>
<h4 class="date"><em>Apr 3, 2017</em></h4>



<div id="installation" class="section level2">
<h2>Installation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rstan)</code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Loading required package: StanHeaders</code></pre>
<pre><code>## rstan (Version 2.15.1, packaged: 2017-04-19 05:03:57 UTC, GitRev: 2e1f913d3ca3)</code></pre>
<pre><code>## For execution on a local, multicore CPU with excess RAM we recommend calling
## rstan_options(auto_write = TRUE)
## options(mc.cores = parallel::detectCores())</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tvvarss)
## for optimizing stan on your machine,
<span class="kw">rstan_options</span>(<span class="dt">auto_write =</span> <span class="ot">TRUE</span>)
<span class="kw">options</span>(<span class="dt">mc.cores =</span> parallel::<span class="kw">detectCores</span>())</code></pre></div>
</div>
<div id="model-fitting" class="section level2">
<h2>Model Fitting</h2>
<p>There is a single function to fit TVVARSS models: <code>tvvarss</code>. At a minimum, the user needs to specify the time series data as an array <code>y</code> where <code>dim(y) = c(n_sites, n_year, n_species)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tvvarss</span>(<span class="dt">y =</span> y)</code></pre></div>
<p>The full set of function options is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tvvarss</span>(<span class="dt">y =</span> y, <span class="dt">include_trend =</span> <span class="ot">TRUE</span>, <span class="dt">de_mean =</span> <span class="ot">TRUE</span>, <span class="dt">x0 =</span> <span class="ot">NULL</span>,
        <span class="dt">shared_q =</span> <span class="ot">NULL</span>, <span class="dt">shared_r =</span> <span class="ot">NULL</span>, <span class="dt">shared_u =</span> <span class="ot">NULL</span>,
        <span class="dt">mcmc_iter =</span> <span class="dv">1000</span>, <span class="dt">mcmc_warmup =</span> <span class="dv">500</span>, <span class="dt">mcmc_thin =</span> <span class="dv">1</span>, <span class="dt">mcmc_chain =</span> <span class="dv">3</span>)</code></pre></div>
<p>The sampling parameters with the <code>mcmc_</code> prefix are straightforward (and need to be set to much smaller models than the same models in JAGS). However, the remaining parameters are useful for changing the model structure.</p>
</div>
<div id="data-1-site" class="section level2">
<h2>Data (1 site)</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
## number of time steps
TT &lt;-<span class="st"> </span><span class="dv">30</span>
## number of spp/guilds
nn &lt;-<span class="st"> </span><span class="dv">4</span>
## CASE 1: linear food chain
B0_lfc &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">list</span>(<span class="dv">0</span>),nn,nn)
for(i in <span class="dv">1</span>:(nn<span class="dv">-1</span>)) {
  B0_lfc[i,i<span class="dv">+1</span>] &lt;-<span class="st"> &quot;td&quot;</span>
  B0_lfc[i<span class="dv">+1</span>,i] &lt;-<span class="st"> &quot;bu&quot;</span>
}
for(i in <span class="dv">1</span>:nn) {
  B0_lfc[i,i] =<span class="st"> &quot;dd&quot;</span>
}
## simulate &amp; plot states
lfc &lt;-<span class="st"> </span><span class="kw">simTVVAR</span>(B0_lfc,TT,<span class="dt">var_QX=</span><span class="kw">rev</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>)/<span class="dv">40</span>),<span class="dt">cov_QX=</span><span class="dv">0</span>,<span class="dt">var_QB=</span><span class="fl">0.05</span>,<span class="dt">cov_QB=</span><span class="dv">0</span>)
<span class="kw">matplot</span>(<span class="kw">t</span>(lfc$states),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="observation-error" class="section level2">
<h2>Observation Error</h2>
<p>We can use the <code>sim2fit</code> function to add observation error to the simulated process. It requires a <code>simTVVAR</code> object and the number of desired realizations of the process.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat_obs =<span class="st"> </span><span class="kw">sim2fit</span>(lfc, <span class="dt">n_sims =</span> <span class="dv">1</span>)</code></pre></div>
</div>
<div id="fitting" class="section level2">
<h2>Fitting</h2>
<p>Now we can use <code>tvvarss</code> to estimate the parameters in the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_fit =<span class="st"> </span><span class="kw">tvvarss</span>(<span class="dt">y =</span> dat_obs, <span class="dt">B =</span> B, <span class="dt">include_trend =</span> <span class="ot">FALSE</span>, <span class="dt">de_mean =</span> <span class="ot">TRUE</span>, <span class="dt">x0 =</span> <span class="ot">NULL</span>,
                  <span class="dt">shared_q =</span> <span class="ot">NULL</span>, <span class="dt">shared_r =</span> <span class="ot">NULL</span>, <span class="dt">shared_u =</span> <span class="ot">NULL</span>,
                  <span class="dt">mcmc_iter =</span> <span class="dv">200</span>, <span class="dt">mcmc_warmup =</span> <span class="dv">100</span>, <span class="dt">mcmc_thin =</span> <span class="dv">1</span>, <span class="dt">mcmc_chain =</span> <span class="dv">1</span>)</code></pre></div>
</div>
<div id="validation" class="section level2">
<h2>Validation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## extract fitted values
pred =<span class="st"> </span><span class="kw">apply</span>(<span class="kw">extract</span>(mod_fit, <span class="kw">c</span>(<span class="st">&quot;pred&quot;</span>))$pred, <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>), mean)
## plot observations and estimated states
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>))
for(i in <span class="dv">1</span>:<span class="dv">4</span>) {
  <span class="kw">plot</span>(pred[,i], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(<span class="kw">c</span>(dat_obs[,i], pred[,i])))
  <span class="kw">points</span>(dat_obs[,i], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
}</code></pre></div>
</div>
<div id="working-with-parameters" class="section level2">
<h2>Working with parameters</h2>
<p>The function <code>tvvarss</code> returns a <code>stanfit</code> object. This can be plotted directly, using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mod_fit, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;B[3,2,2]&quot;</span>))
<span class="kw">traceplot</span>(mod_fit, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;B[3,2,2]&quot;</span>))</code></pre></div>
<p>Or the parameters may be stored in a new object,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pars =<span class="st"> </span><span class="kw">extract</span>(mod_fit, <span class="dt">permuted =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>To retain the original samples by MCMC chain, set <code>permuted=FALSE</code></p>
<p>Parameters may also be extracted via the <code>broom</code> package, into a data frame that just contains the estimate and standard error (where they can be passed to ggplot, etc).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(broom)
tidy_pars =<span class="st"> </span><span class="kw">tidy</span>(mod_fit)</code></pre></div>
</div>
<div id="model-selection" class="section level2">
<h2>Model Selection</h2>
<p>Fitted <code>tvvarss</code> objects can be compared to one another using the <code>loo</code> package for model selection, which can compute either the Leave One Out Information Criterion (LOOIC) or Watanabeâ€™s Akaike Information Criterion (WAIC). For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(loo)
LL &lt;-<span class="st"> </span><span class="kw">loo</span>(<span class="kw">extract_log_lik</span>(mod_fit))
## LOOIC
looic &lt;-<span class="st"> </span>LL$looic
## WAIC
waic &lt;-<span class="st"> </span>LL$waic</code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
